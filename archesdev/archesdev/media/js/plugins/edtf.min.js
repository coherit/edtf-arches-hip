(function(e){function t(e){var t,n,r=[],i;t=e.replace(/(^|-)([0-9u\-]+)([?~])/g,"$1($2)$3").replace(/~\?/g,"?~");for(var s=0;s<e.match(/[0-9u]+/g).length;s++)t=t.replace(/(^|[^T])([0-9u]+)/,"$1T"+s),r[s]={uncertain:!1,approximate:!1};i=function(e){var n;return n=t.slice(0,t.indexOf(")"+e)+1),n=n.replace(/\((.*)\)/,"$1"),n.replace(/[^0-9]/g,"").split(/\B/)};if(e.indexOf("?")>=0)for(var s=0;s<e.match(/\?/g).length;s++){n=i("?");for(var o=0;o<n.length;o++)r[n[o]].uncertain=!0;t=t.replace("?","")}if(e.indexOf("~")>=0)for(var s=0;s<e.match(/~/g).length;s++){n=i("~");for(var o=0;o<n.length;o++)r[n[o]].approximate=!0;t=t.replace("~","")}return r}function n(e){var t,n=e.split(/([?~]*)$/),r=n[0].split(/(?!^)-/),i=/^-?[0-9]{0,2}(?:[0-9]{2}|[0-9]u|uu)$/,s=/^-?(?:[0-9]{1,4}|y[0-9]{5,})$/,o=/^(?:[0-9]{2}|uu)$/,u,a,f,l;switch(r.length){case 1:u=r[0],t=i.test(u)||s.test(u);break;case 2:u=r[0],a=r[1],t=s.test(u)&&o.test(a),/[0-9]/.test(a)&&(t=t&&(a>=1&&a<=12||a>=21&&a<=24));break;case 3:u=r[0],a=r[1],f=r[2].split("T")[0],t=s.test(u)&&(/^[0-9]{2}$/.test(a)&&o.test(f)||/^uu$/.test(a)&&/^uu$/.test(f)),/[0-9]/.test(a)&&(t=a>=1&&a<=12&&t),/[0-9]/.test(f)&&(t=f>=1&&f<=31&&t);break;default:t=!1}return!!t}function s(e){var t,n={};return e==="unknown"?new i({unknown:!0}):e==="open"?new i({open:!0}):(t=e.replace(/(?!^)-/g," ").replace(/[?~]/g," $1").split(" "),t.indexOf("?")>=0&&(n.uncertain=!!t.splice(t.indexOf("?"),1)[0]),t.indexOf("~")>=0&&(n.approximate=!!t.splice(t.indexOf("~"),1)[0]),n.year=t.splice(0,1)[0],n.month=t.splice(0,1)[0],n.day=t.splice(0,1)[0],new i(n))}var r=function(e){var t,r=e.split("/");switch(r.length){case 1:t=n(r[0]);break;case 2:t=r[0].length&&r[1].length&&(n(r[0])||/^unknown$/.test(r[0]))&&(n(r[1])||/^(?:open|unknown)$/.test(r[1]));break;default:t=!1}return!!t};e.validateEDTF=r;var i=function(e){return this.year=e.year?""+e.year:null,this.month=e.year?zeroPadded(e.month):null,this.day=e.year?zeroPadded(e.day):null,this.uncertain=!!e.uncertain,this.approximate=!!e.approximate,this.open=!!e.open,this.unknown=!!e.unknown,this};i.prototype={asEDTFString:function(){var e="";return this.open?"open":this.unknown?"unknown":(e+=this.year,this.month&&(e+="-"+this.month),this.day&&(e+="-"+this.day),this.uncertain&&(e+="?"),this.approximate&&(e+="~"),e)},toString:function(){return this.asEDTFString()},toNativeDate:function(){var e=new Date(0);if(this.unknown||this.open)return null;if(this.year<-271820||this.year>275759)return null;if(this.year.indexOf("uu")>=0)return null;e.setFullYear(this.year);switch(this.month){case null:case"uu":e.setMonth(0),e.setDate(1);break;case 21:e.setMonth(2),e.setDate(22);break;case 22:e.setMonth(5),e.setDate(22);break;case 23:e.setMonth(8),e.setDate(22);break;case 24:e.setMonth(11),e.setDate(22);break;default:e.setMonth(parseInt(this.month,10)-1),this.day===null||this.day==="uu"?e.setDate(1):e.setDate(parseInt(this.day,10))}return e}}})(typeof exports=="undefined"?this.edtf={}:exports);